!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ZoroAjax=t():e.ZoroAjax=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r={ajax:n(2),json:n(5),upload:n(9)};e.exports=r},function(e,t,n){!function(t,n){e.exports=n()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}t.__esModule=!0;var i=n(5),a=o(i),u=n(7),s=o(u),c=n(6),f=o(c),d=n(8),l=o(d),p=n(9),h=o(p),v=n(1),m=r(v),y=n(10),g=o(y),b=n(3),x=r(b),E=n(4),L=o(E),w=n(2),O=o(w),S=n(11),_=o(S),j=L.merge({},a,s,f,l,h,{forOwn:m["default"]},g,{mixin:x["default"]},L,O,_);delete j.__esModule,t["default"]=j,e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0,t["default"]=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1],n=arguments[2];for(var r in e)e.hasOwnProperty(r)&&t.call(n,r,e[r])},e.exports=t["default"]},function(e,t){"use strict";function n(e){return Object.prototype.toString.call(e).slice(8,-1)}function r(e){return n(e).toLowerCase()}function o(e){return"string"===r(e)}function i(e){return"number"===r(e)}function a(e){return"boolean"===r(e)}function u(e){return"array"===r(e)}function s(e){return"function"===r(e)}function c(e){return"date"===r(e)}function f(e){return"regexp"===r(e)}function d(e){return"error"===r(e)}function l(e){return null===e}function p(e){return null!==e}function h(e){return"undefined"==typeof e}function v(e){return"undefined"!=typeof e}function m(e){return v(e)&&p(e)}function y(e){return h(e)||l(e)}function g(e){return m(e)&&"object"===r(e)}function b(e){return y(e)||(o(e)||u(e))&&0===e.length}t.__esModule=!0,t.getClass=n,t.typeOf=r,t.isString=o,t.isNumber=i,t.isBoolean=a,t.isArray=u,t.isFunction=s,t.isDate=c,t.isRegExp=f,t.isError=d,t.isnull=l,t.notnull=p,t.undef=h,t.notundef=v,t.exist=m,t.notexist=y,t.isObject=g,t.isEmpty=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var o=n(1),i=r(o);t["default"]=function(e,t){(0,i["default"])(t,function(t,n){e[t]=n})},e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return JSON.parse(JSON.stringify(e))}function i(){for(var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];var o=!0,i=!1,a=void 0;try{for(var u,s=n[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var c=u.value;(0,l["default"])(e,c)}}catch(f){i=!0,a=f}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return e}function a(e,t){return(0,h["default"])(t,function(t,n){(0,v.undef)(e[t])&&(e[t]=n)}),e}function u(e,t,n){var r=e[t]||e[t.toLowerCase()];return(0,v.notexist)(r)&&(r=n,e[t]=r),r}function s(e,t){return(0,h["default"])(e,function(n,r){(0,v.exist)(t[n])&&(e[n]=t[n])}),e}function c(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],t=arguments.length<=1||void 0===arguments[1]?",":arguments[1],n={};return e.split(t).forEach(function(e){var t=e.split("="),r=t.shift();r&&(n[decodeURIComponent(r)]=decodeURIComponent(t.join("=")))}),n}function f(e,t,n){if(!e)return"";var r=[];return(0,h["default"])(e,function(e,t){(0,v.isFunction)(t)||((0,v.isDate)(t)?t=t.getTime():(0,v.isArray)(t)?t=t.join(","):(0,v.isObject)(t)&&(t=JSON.stringify(t)),n&&(t=encodeURIComponent(t)),r.push(encodeURIComponent(e)+"="+t))}),r.join(t||",")}t.__esModule=!0,t.simpleClone=o,t.merge=i,t.fillUndef=a,t.checkWithDefault=u,t.fetch=s,t.string2object=c,t.object2string=f;var d=n(3),l=r(d),p=n(1),h=r(p),v=n(2)},function(e,t){"use strict";function n(e){var t=void 0;t=e.split(",")[0].indexOf("base64")>=0?window.atob(e.split(",")[1]):window.decodeURIComponent(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],r=new window.Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return new window.Blob([r],{type:n})}t.__esModule=!0,t.blobFromDataURL=n},function(e,t){"use strict";t.__esModule=!0,t.o={},t.emptyObj={},t.f=function(){},t.emptyFunc=function(){},t.regBlank=/\s+/gi,t.regWhiteSpace=/\s+/gi},function(e,t){"use strict";function n(e){var t=!1,n="Webkit Moz ms O".split(" "),r=document.createElement("div"),o=null;if(e=e.toLowerCase(),void 0!==r.style[e]&&(t=!0),t===!1){o=e.charAt(0).toUpperCase()+e.substr(1);for(var i=0;i<n.length;i++)if(void 0!==r.style[n[i]+o]){t=!0;break}}return t}t.__esModule=!0,t.detectCSSFeature=n},function(e,t){"use strict";function n(e,t){t=t||2;for(var n=""+e;n.length<t;)n="0"+n;return n}function r(e){return""+e.getFullYear()}function o(e){return n(e.getMonth()+1)}function i(e){return n(e.getDate())}function a(e){return n(e.getHours())}function u(e){return n(e.getMinutes())}function s(e){return n(e.getSeconds())}function c(e){return n(e.getMilliseconds(),3)}function f(e){return e=""+e,new Date(e.replace(/-/g,"/").replace("T"," "))}t.__esModule=!0,t.fix=n,t.getYearStr=r,t.getMonthStr=o,t.getDayStr=i,t.getHourStr=a,t.getMinuteStr=u,t.getSecondStr=s,t.getMillisecondStr=c,t.dateFromDateTimeLocal=f,t.format=function(){var e=/yyyy|MM|dd|hh|mm|ss|SSS/g,t={yyyy:r,MM:o,dd:i,hh:a,mm:u,ss:s,SSS:c};return function(n,r){return n=new Date(n),isNaN(+n)?"invalid date":(r=r||"yyyy-MM-dd",r.replace(e,function(e){return t[e](n)}))}}()},function(e,t,n){"use strict";function r(e){var t=e.parentNode||document.body;e=e.cloneNode(!0),e.style.display="block",e.style.opacity=0,e.style.height="auto",t.appendChild(e);var n=e.offsetHeight;return t.removeChild(e),n}function o(e){e.parentNode&&e.parentNode.removeChild(e)}function i(e,t,n){return(0,c.exist)(n)?void e.setAttribute("data-"+t,n):e.getAttribute("data-"+t)}function a(e){return e.target||e.srcElement}function u(e){e=e||{};var t=document.createElement("iframe");if(t.frameBorder=0,e.name&&(t.name=e.name),e.visible||(t.style.display="none"),(0,c.isFunction)(e.onload)){var n=function i(n){t.src&&(e.multi||p(t,"load",i),e.onload(n))};d(t,"load",n)}var r=e.parent;(r||document.body).appendChild(t);var o=e.src||"about:blank";return setTimeout(function(){t.src=o},0),t}function s(e){var t=window.document.createElement("div");t.innerHTML=e;var n=[],r=void 0,o=void 0;if(t.children)for(r=0,o=t.children.length;o>r;r++)n.push(t.children[r]);else for(r=0,o=t.childNodes.length;o>r;r++){var i=t.childNodes[r];1===i.nodeType&&n.push(i)}return n.length>1?t:n[0]}t.__esModule=!0,t.off=t.removeEventListener=t.on=t.addEventListener=void 0,t.calcHeight=r,t.remove=o,t.dataset=i,t.target=a,t.createIframe=u,t.html2node=s;var c=n(2),f=t.addEventListener=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},d=t.on=f,l=t.removeEventListener=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},p=t.off=l},function(e,t){"use strict";t.__esModule=!0,t.uniqueID=function(){var e=0;return function(){return""+e++}}()},function(e,t,n){"use strict";function r(e){return e.indexOf("?")<0?"?":"&"}function o(e){return(0,i.object2string)(e,"&",!0)}t.__esModule=!0,t.url2origin=void 0,t.genUrlSep=r,t.object2query=o;var i=n(4);t.url2origin=function(){var e=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(t){return e.test(t||"")?RegExp.$1.toLowerCase():""}}()}])})},function(e,t,n){"use strict";function r(e){var t=e.mode,n=p;return window.FormData||(t="iframe"),"iframe"===t&&(n=e.upload?h:v),new n(e)}function o(e){var t=e.upload="multipart/form-data"===(e.headers||l.o)["Content-Type"],n=(location.protocol+"//"+location.host).toLowerCase(),o=l.url2origin(e.url),i=n!==o;return t||i||e.mode?r(e):new p(e)}function i(e){var t=m[e];t&&(t.req.destroy(),delete m[e])}function a(e,t){t={data:t};var n=e.result.headers;return n&&(t.headers=e.req.header(n)),t}function u(e,t,n){var r=m[e];if(r){"onload"===t&&r.result&&(n=a(r,n)),i(e);var o={type:t,result:n};y(o),o.stopped||r[t](o.result)}}function s(e,t){u(e,"onload",t)}function c(e,t){u(e,"onerror",t)}function f(e,t){var n=l.genUrlSep(e);return t=t||"",l.isObject(t)&&(t=l.object2query(t)),t&&(e+=n+t),e}function d(e,t){t=t||{};var n=l.uniqueID(),r={result:t.result,onload:t.onload||l.f,onerror:t.onerror||l.f};m[n]=r,t.onload=s.bind(null,n),t.onerror=c.bind(null,n),t.query&&(e=f(e,t.query));var i=t.method||"";return i&&!/get/i.test(i)||!t.data||(e=f(e,t.data),t.data=null),t.url=e,r.req=o(t),n}var l=n(1),p=n(8),h=n(7),v=n(6),m={},y=l.f;d.filter=function(e){l.isFunction(e)&&(y=e)},d.abort=function(e){var t=m[e];t&&t.req.abort()},e.exports=d},function(e,t,n){"use strict";function r(e){var t=this;e.onload&&t.once("load",e.onload),e.onerror&&t.once("error",e.onerror),e.onbeforesend&&t.once("beforesend",e.onbeforesend),e.onaftersend&&t.once("aftersend",e.onaftersend),e=t.options=o.fetch({method:"GET",url:"",sync:!1,data:null,headers:{},cookie:!1,timeout:6e3,type:"text",form:null,input:null,putFileAtEnd:!1,proxyUrl:""},e);var n=e.headers,r="Content-Type";o.notexist(n[r])&&(n[r]="application/x-www-form-urlencoded"),t.send()}var o=n(1),i=o.f,a=n(10),u=r.prototype=Object.create(a.prototype);u.send=function(){var e=this,t=e.options;setTimeout(function(){try{try{e.emit("beforesend",t)}catch(n){console.error("ignore",n)}e.doSend()}catch(n){console.error("ignore",n),e.onError("serverError","请求失败:"+n.message)}},0)},u.doSend=i,u.afterSend=function(){var e=this;setTimeout(function(){e.emit("aftersend",e.options)},0)},u.onLoad=function(e){var t=this,n=t.options,r=e.status,o=e.result;if(0!==(""+r).indexOf("2"))return void t.onError("serverError","服务器返回异常状态",{status:r,result:o});if("json"===n.type)try{o=JSON.parse(o)}catch(i){return console.error("ignore",i),void t.onError("parseError",o)}t.emit("load",o)},u.onError=function(e,t,n){var r=o.isObject(n)?n:{};r.code=e||"error",r.message=t||"发生错误",this.emit("error",r)},u.onTimeout=function(){this.onError("timeout","请求超时")},u.abort=function(){this.onError("abort","客户端中止")},u.header=function(e){var t=this;if(!o.isArray(e))return t.getResponseHeader(e||"");var n={};return e.forEach(function(e){n[e]=t.header(e)}),n},u.getResponseHeader=i,u.destroy=i,e.exports=r},function(e,t){"use strict";var n={};n.isFileInput=function(e){return e.tagName&&"INPUT"===e.tagName.toUpperCase()||window.Blob&&e instanceof window.Blob},n.getKeys=function(e,t){var r=Object.keys(e);return t&&r.sort(function(t,r){var o=n.isFileInput(e[t]),i=n.isFileInput(e[r]);return o===i?0:o?1:-1}),r},e.exports=n},function(e,t,n){"use strict";var r=n(1),o=n(2),i=function(){var e=/json/i,t=/post/i;return function(n,i){i=i||{};var a=i.data=i.data||{},u=i.headers=i.headers||{},s=r.checkWithDefault(u,"Accept","application/json"),c=r.checkWithDefault(u,"Content-Type","application/json");return e.test(s)&&(i.type="json"),t.test(i.method)&&e.test(c)&&(i.data=JSON.stringify(a)),o(n,i)}}();r.mixin(i,o),o.json=i,e.exports=i},function(e,t,n){"use strict";function r(e){var t=this;t.init(),i.call(t,e)}var o=n(1),i=n(3),a={},u=i.prototype,s=r.prototype=Object.create(u);s.init=function(){function e(e){var t=e.data;if(0===t.indexOf(n)){t=JSON.parse(t.replace(n,""));var r=t.key,o=a[r];o&&(delete a[r],t.result=decodeURIComponent(t.result||""),o.onLoad(t))}}function t(){r||(r=!0,o.on(window,"message",e))}var n="NEJ-AJAX-DATA:",r=!1;return function(){t()}}(),s.doSend=function(){var e=this,t=e.options,n=o.url2origin(t.url),r=t.proxyUrl||n+"/res/nej_proxy_frame.html",i=a[r];if(o.isArray(i))return void i.push(e.doSend.bind(e,t));if(!i)return a[r]=[e.doSend.bind(e,t)],void o.createIframe({src:r,onload:function(e){var t=a[r];a[r]=o.target(e).contentWindow,t.forEach(function(e){try{e()}catch(t){}})}});if(!e.aborted){var u=e.key=o.uniqueID();a[u]=e;var s=o.fetch({method:"GET",url:"",data:null,headers:{},timeout:0},t);s.key=u,i.postMessage(JSON.stringify(s),"*"),e.afterSend()}},s.abort=function(){var e=this;e.aborted=!0,delete a[e.key],u.abort.call(e)},e.exports=r},function(e,t,n){"use strict";function r(e){var t=this;t.init(),a.call(t,e)}var o=n(1),i=n(4),a=n(3),u="NEJ-UPLOAD-RESULT:",s={},c=a.prototype,f=r.prototype=Object.create(c);f.init=function(){function e(e){var t=e.data;if(0===t.indexOf(u)){t=JSON.parse(t.replace(u,""));var n=t.key,r=s[n];r&&(delete s[n],t.result=decodeURIComponent(t.result||""),r.onLoad(t.result))}}function t(){n||(n=!0,o.on(window,"message",e))}var n=!1;return function(){t()}}(),f.doSend=function(){function e(){d.forEach(function(e,t){var n=l[t];e.name=n.name,e.setAttribute("form",n.getAttribute("form")),n.parentNode.replaceChild(e,n)})}var t=this,n=t.options,r=t.key=o.uniqueID();s[r]=t;var a=t.form=o.html2node('<form style="display:none;"></form>');document.body.appendChild(a),a.target=r,a.method="POST",a.enctype="multipart/form-data",a.encoding="multipart/form-data";var u=n.url,c=o.genUrlSep(u);a.action=u+c+"_proxy_=form";var f=n.data,d=[],l=[];f&&i.getKeys(f,n.putFileAtEnd).forEach(function(e){var t=f[e];if(t.tagName&&"INPUT"===t.tagName.toUpperCase()){if("file"===t.type){var n=t,r=n.cloneNode(!0);n.parentNode.insertBefore(r,n);var i=o.dataset(n,"name");i&&(n.name=i),a.appendChild(n),n.setAttribute("form",""),n.removeAttribute("form"),d.push(t),l.push(r)}}else{var u=o.html2node('<input type="hidden"/>');u.name=e,u.value=t,a.appendChild(u)}});var p=t.iframe=o.createIframe({name:r,onload:function(){return t.aborted?void e():(o.on(p,"load",t.checkResult.bind(t)),a.submit(),e(),void t.afterSend())}})},f.checkResult=function(){var e,t,n=this;try{if(e=n.iframe.contentWindow.document.body,t=(e.innerText||e.textContent||"").trim(),t.indexOf(u)>=0||e.innerHTML.indexOf(u)>=0)return}catch(r){return void console.error("ignore",r)}n.onLoad(t)},f.onLoad=function(e){var t=this;c.onLoad.call(t,{status:200,result:e}),o.remove(t.form),o.remove(t.iframe),c.destroy.call(t)},f.abort=function(){var e=this;e.aborted=!0,delete s[e.key],c.abort.call(e)},e.exports=r},function(e,t,n){"use strict";function r(e){var t=this;e.onuploading&&t.on("uploading",e.onuploading),a.call(t,e)}var o=n(1),i=n(4),a=n(3),u=a.prototype,s=r.prototype=Object.create(u);s.doSend=function(){var e=this,t=e.options,n=t.headers,r=e.xhr=new XMLHttpRequest;if("multipart/form-data"===n["Content-Type"]){delete n["Content-Type"],r.upload.onprogress=e.onProgress.bind(e),r.upload.onload=e.onProgress.bind(e);var a=t.data;t.data=new FormData,a&&i.getKeys(a,t.putFileAtEnd).forEach(function(e){var n=a[e];n.tagName&&"INPUT"===n.tagName.toUpperCase()?"file"===n.type&&[].forEach.call(n.files,function(e){t.data.append(o.dataset(n,"name")||n.name||e.name||"file-"+o.uniqueID(),e)}):t.data.append(e,n)})}r.onreadystatechange=e.onStateChange.bind(e),0!==t.timeout&&(e.timer=setTimeout(e.onTimeout.bind(e),t.timeout)),r.open(t.method,t.url,!t.sync),Object.keys(n).forEach(function(e){r.setRequestHeader(e,n[e])}),t.cookie&&"withCredentials"in r&&(r.withCredentials=!0),r.send(t.data),e.afterSend()},s.onProgress=function(e){e.lengthComputable&&e.loaded<=e.total&&this.emit("uploading",e)},s.onStateChange=function(){var e=this,t=e.xhr;4===t.readyState&&e.onLoad({status:t.status,result:t.responseText||""})},s.getResponseHeader=function(e){var t=this.xhr;return t?t.getResponseHeader(e):""},s.destroy=function(){var e=this;clearTimeout(e.timer);try{e.xhr.onreadystatechange=o.f,e.xhr.abort()}catch(t){console.error("ignore",t)}u.destroy.call(e)},e.exports=r},function(e,t,n){"use strict";var r=n(1),o=n(2),i=function(e,t){return t.method="POST",t.headers=t.headers||{},t.headers["Content-Type"]="multipart/form-data",t.timeout=0,t.type=t.type||"json",o(e,t)};r.mixin(i,o),o.upload=i,e.exports=i},function(e,t,n){var r;(function(){"use strict";function t(){}function o(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function i(e){return function(){return this[e].apply(this,arguments)}}var a=t.prototype,u=this,s=u.EventEmitter;a.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp){t={};for(n in r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n])}else t=r[e]||(r[e]=[]);return t},a.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},a.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},a.addListener=function(e,t){var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&o(r[n],t)===-1&&r[n].push(i?t:{listener:t,once:!1});return this},a.on=i("addListener"),a.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},a.once=i("addOnceListener"),a.defineEvent=function(e){return this.getListeners(e),this},a.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},a.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&(n=o(i[r],t),n!==-1&&i[r].splice(n,1));return this},a.off=i("removeListener"),a.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},a.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},a.manipulateListeners=function(e,t,n){var r,o,i=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)i.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(o=t[r])&&("function"==typeof o?i.call(this,r,o):a.call(this,r,o));return this},a.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},a.removeAllListeners=i("removeEvent"),a.emitEvent=function(e,t){var n,r,o,i,a,u=this.getListenersAsObject(e);for(i in u)if(u.hasOwnProperty(i))for(n=u[i].slice(0),o=n.length;o--;)r=n[o],r.once===!0&&this.removeListener(e,r.listener),a=r.listener.apply(this,t||[]),a===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},a.trigger=i("emitEvent"),a.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},a.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},a._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},a._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return u.EventEmitter=s,t},r=function(){return t}.call(u,n,u,e),!(void 0!==r&&(e.exports=r))}).call(this)}])});